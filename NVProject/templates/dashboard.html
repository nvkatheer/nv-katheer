{% extends 'base.html' %}

{% block title %}Dashboard - NV Poultry Farm{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="mb-0" style="color: #2c5282;  font-weight: 600; font-size: 1.25rem;">
            <i class="fas fa-feather-alt me-2"></i>katheer Statistics
        </h2>
        <div class="d-flex align-items-center gap-3">
            <div class="date-selector">
                <input type="date" id="dashboard-date" class="form-control" value="{{ today_date|date:'Y-m-d' }}"
                    onchange="updateDashboard(this.value)">
            </div>
            <div class="date-display p-2 rounded" style="background: rgba(66, 153, 225, 0.1); color: #2c5282;">
                <i class="far fa-calendar-alt me-2"></i><span id="display-date">{{ today_date|date:"F d, Y" }}</span>
            </div>
        </div>
    </div>

    <!-- katheer Stats Cards - 5 Cards Layout -->
    <div class="row g-4">
        <!-- Egg Percentage Card -->
        <div class="col-xl-2-5">
            <div class="card egg-percentage-card h-100 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle p-3 me-3">
                            <i class="fas fa-chart-pie fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="card-title mb-0">Egg Percentage</h6>
                            <small class="text-muted">Eggs per bird</small>
                        </div>
                    </div>
                    <div class="d-flex align-items-baseline">
                        <h3 class="mb-0 me-2" style="font-weight: 700;">{{ egg_percentage }}</h3>
                        <span class="text-muted">%</span>
                    </div>
                    {% if not katheer_record_exists %}
                    <small class="text-danger"><i class="fas fa-exclamation-circle me-1"></i>No record for today</small>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- katheer Total Eggs Card -->
        <div class="col-xl-2-5">
            <div class="card katheer-eggs-card h-100 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle p-3 me-3">
                            <i class="fas fa-egg fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="card-title mb-0">katheer Total Eggs</h6>
                            <small class="text-muted">Total eggs collected</small>
                        </div>
                    </div>
                    <div class="d-flex align-items-baseline">
                        <h3 class="mb-0 me-2" style="font-weight: 700;">{{ katheer_total_eggs }}</h3>
                        <span class="text-muted">Eggs</span>
                    </div>
                    {% if not katheer_record_exists %}
                    <small class="text-danger"><i class="fas fa-exclamation-circle me-1"></i>No record for today</small>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Feed Per Bird Card -->
        <div class="col-xl-2-5">
            <div class="card feed-per-bird-card h-100 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle p-3 me-3">
                            <i class="fas fa-balance-scale fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="card-title mb-0">Feed Per Bird</h6>
                            <small class="text-muted">Today's intake</small>
                        </div>
                    </div>
                    <div class="d-flex align-items-baseline">
                        <h3 class="mb-0 me-2" style="font-weight: 700;">{{ feed_per_gram_per_bird }}</h3>
                        <span class="text-muted">gm</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Male Feed Per Bird Card -->
        <div class="col-xl-2-5">
            <div class="card male-feed-bird-card h-100 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle p-3 me-3">
                            <i class="fas fa-drumstick-bite fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="card-title mb-0">Male Feed</h6>
                            <small class="text-muted">Per male bird</small>
                        </div>
                    </div>
                    <div class="d-flex align-items-baseline">
                        <h3 class="mb-0 me-2" style="font-weight: 700;">{{ male_feed_per_bird }}</h3>
                        <span class="text-muted">gm</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Female Feed Per Bird Card -->
        <div class="col-xl-2-5">
            <div class="card female-feed-bird-card h-100 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="rounded-circle p-3 me-3">
                            <i class="fas fa-egg fa-2x"></i>
                        </div>
                        <div>
                            <h6 class="card-title mb-0">Female Feed</h6>
                            <small class="text-muted">Per female bird</small>
                        </div>
                    </div>
                    <div class="d-flex align-items-baseline">
                        <h3 class="mb-0 me-2" style="font-weight: 700;">{{ female_feed_per_bird }}</h3>
                        <span class="text-muted">gm</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Birds Count & Feed Management Section -->
    <div class="row g-4 mt-4">
        <h3 class="mb-3 mt-2" style="color: #2c5282; font-weight: 600;">Bird Count Summary</h3>
        
        <!-- Total Birds Card -->
        <div class="col-xl-1-7">
            <div class="card total-birds-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-users fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Total Birds</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Males + Females</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;" id="total-birds-count">{{ total_current_birds }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">Birds</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Male Birds Card (3rd) -->
        <div class="col-xl-1-7">
            <div class="card male-birds-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-feather fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Male Birds</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Current count</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;" id="male-birds-count">{{ male_current_birds }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">Birds</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Female Birds Card (5th) -->
        <div class="col-xl-1-7">
            <div class="card female-birds-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-dove fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Female Birds</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Current count</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;" id="female-birds-count">{{ female_current_birds }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">Birds</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Male Mortality Card (5th) -->
        <div class="col-xl-1-7">
            <div class="card male-mortality-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-heart-broken fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Male Mortality</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Today's deaths</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;" id="male-mortality-count">{{ male_today_mortality }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">Birds</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Female Mortality Card (6th) -->
        <div class="col-xl-1-7">
            <div class="card female-mortality-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-heart-broken fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Female Mortality</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Today's deaths</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;" id="female-mortality-count">{{ female_today_mortality }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">Birds</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Total Feed Taken Today Card -->
        <div class="col-xl-1-7">
            <div class="card feed-today-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-weight fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Feed Taken Today</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Total kg</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;">{{ total_feed_today }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">kg</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Closing Stock Card -->
        <div class="col-xl-1-7">
            <div class="card closing-stock-card h-100 border-0 shadow-sm">
                <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center text-center mb-2">
                        <div class="rounded-circle p-2 mb-2" style="width: 45px; height: 45px; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-warehouse fa-sm"></i>
                        </div>
                        <h6 class="card-title mb-0" style="font-size: 0.85rem;">Closing Stock</h6>
                        <small class="text-muted" style="font-size: 0.65rem;">Remaining</small>
                    </div>
                    <div class="text-center">
                        <h3 class="mb-0" style="font-weight: 700; font-size: 1.5rem;">{{ closing_stock }}</h3>
                        <small class="text-muted" style="font-size: 0.65rem;">kg</small>
                    </div>
                </div>
            </div>
        </div>
    </div>


</div>

</div>

<!-- Add custom styles -->
<style>
    body {
        background-color: #f0f2f5;
        min-height: 100vh;
    }

    .container {
        background-color: #f8fafc;
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        max-height: 100vh;
        overflow-y: auto;
    }

    .card {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border-radius: 12px;
        min-height: 140px;
    }

    .row.g-4 {
        margin-bottom: 1rem;
    }

    .mt-4 {
        margin-top: 1rem !important;
    }

    .card-body {
        padding: 1rem;
    }

    .col-md-4 {
        flex: 0 0 auto;
        width: 33.33333%;
    }

    /* Feed Card */
    .card.feed-card {
        background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%);
        color: white;
    }

    .feed-card .card-title,
    .feed-card .text-muted,
    .feed-card h3,
    .feed-card span {
        color: white !important;
    }

    .feed-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .feed-card i {
        color: white !important;
    }

    /* katheer Tray Eggs Card */
    .card.katheer-tray-card {
        background: linear-gradient(135deg, #f6ad55 0%, #d69e2e 100%);
        color: white;
    }

    .katheer-tray-card .card-title,
    .katheer-tray-card .text-muted,
    .katheer-tray-card h3,
    .katheer-tray-card span {
        color: white !important;
    }

    .katheer-tray-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .katheer-tray-card i {
        color: white !important;
    }

    /* katheer Total Eggs Card */
    .card.katheer-eggs-card {
        background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
        color: white;
    }

    .katheer-eggs-card .card-title,
    .katheer-eggs-card .text-muted,
    .katheer-eggs-card h3,
    .katheer-eggs-card span {
        color: white !important;
    }

    .katheer-eggs-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .katheer-eggs-card i {
        color: white !important;
    }

    /* Male Birds Card */
    .card.male-birds-card {
        background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
        color: white;
    }

    .male-birds-card .card-title,
    .male-birds-card .text-muted,
    .male-birds-card h3,
    .male-birds-card span,
    .male-birds-card small {
        color: white !important;
    }

    .male-birds-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .male-birds-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Female Birds Card */
    .card.female-birds-card {
        background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
        color: white;
    }

    .female-birds-card .card-title,
    .female-birds-card .text-muted,
    .female-birds-card h3,
    .female-birds-card span,
    .female-birds-card small {
        color: white !important;
    }

    .female-birds-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .female-birds-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Total Birds Card */
    .card.total-birds-card {
        background: linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%);
        color: white;
    }

    .total-birds-card .card-title,
    .total-birds-card .text-muted,
    .total-birds-card h3,
    .total-birds-card span,
    .total-birds-card small {
        color: white !important;
    }

    .total-birds-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .total-birds-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Male Mortality Card */
    .card.male-mortality-card {
        background: linear-gradient(135deg, #f97316 0%, #d97706 100%);
        color: white;
    }

    .male-mortality-card .card-title,
    .male-mortality-card .text-muted,
    .male-mortality-card h3,
    .male-mortality-card span,
    .male-mortality-card small {
        color: white !important;
    }

    .male-mortality-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .male-mortality-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Female Mortality Card */
    .card.female-mortality-card {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        color: white;
    }

    .female-mortality-card .card-title,
    .female-mortality-card .text-muted,
    .female-mortality-card h3,
    .female-mortality-card span,
    .female-mortality-card small {
        color: white !important;
    }

    .female-mortality-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .female-mortality-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Egg Percentage Card */
    .card.egg-percentage-card {
        background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);
        color: white;
    }

    .egg-percentage-card .card-title,
    .egg-percentage-card .text-muted,
    .egg-percentage-card h3,
    .egg-percentage-card span {
        color: white !important;
    }

    .egg-percentage-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .egg-percentage-card i {
        color: white !important;
    }

    /* Feed Per Bird Card */
    .card.feed-per-bird-card {
        background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
        color: white;
    }

    .feed-per-bird-card .card-title,
    .feed-per-bird-card .text-muted,
    .feed-per-bird-card h3,
    .feed-per-bird-card span,
    .feed-per-bird-card small {
        color: white !important;
    }

    .feed-per-bird-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .feed-per-bird-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Male Feed Per Bird Card */
    .card.male-feed-bird-card {
        background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);
        color: white;
    }

    .male-feed-bird-card .card-title,
    .male-feed-bird-card .text-muted,
    .male-feed-bird-card h3,
    .male-feed-bird-card span,
    .male-feed-bird-card small {
        color: white !important;
    }

    .male-feed-bird-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .male-feed-bird-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Female Feed Per Bird Card */
    .card.female-feed-bird-card {
        background: linear-gradient(135deg, #d946ef 0%, #c026d3 100%);
        color: white;
    }

    .female-feed-bird-card .card-title,
    .female-feed-bird-card .text-muted,
    .female-feed-bird-card h3,
    .female-feed-bird-card span,
    .female-feed-bird-card small {
        color: white !important;
    }

    .female-feed-bird-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .female-feed-bird-card i {
        color: white !important;
        display: block !important;
        visibility: visible !important;
    }

    /* Feed Taken Today Card */
    .card.feed-today-card {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        color: white;
    }

    .feed-today-card .card-title,
    .feed-today-card .text-muted,
    .feed-today-card h3,
    .feed-today-card span {
        color: white !important;
    }

    .feed-today-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .feed-today-card i {
        color: white !important;
    }

    /* Closing Stock Card */
    .card.closing-stock-card {
        background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        color: white;
    }

    .closing-stock-card .card-title,
    .closing-stock-card .text-muted,
    .closing-stock-card h3,
    .closing-stock-card span {
        color: white !important;
    }

    .closing-stock-card .rounded-circle {
        background: rgba(255, 255, 255, 0.2) !important;
    }

    .closing-stock-card i {
        color: white !important;
    }

    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2) !important;
    }

    /* Actions Card */
    .actions-card {
        background: white;
        border: none !important;
    }

    .date-display {
        font-size: 0.95rem;
        font-weight: 500;
        background: white !important;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    }

    .btn {
        padding: 0.5rem 1rem;
        border-radius: 8px;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .btn-primary {
        background-color: #2c5282;
        border-color: #2c5282;
    }

    .btn-primary:hover {
        background-color: #2b6cb0;
        border-color: #2b6cb0;
        transform: translateY(-1px);
    }

    .btn-outline-primary {
        color: #2c5282;
        border-color: #2c5282;
    }

    .btn-outline-primary:hover {
        background-color: #2c5282;
        color: white;
        transform: translateY(-1px);
    }

    .text-danger {
        color: #fff3f3 !important;
    }



    .date-selector .form-control {
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        padding: 0.5rem;
        font-size: 0.95rem;
        background-color: white;
        transition: all 0.2s ease;
    }

    .date-selector .form-control:focus {
        border-color: #4299e1;
        box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.15);
    }

    /* 5 Column Layout for katheer Stats Cards */
    @media (min-width: 1400px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 20%;
        }
    }

    @media (min-width: 1200px) and (max-width: 1399px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 20%;
        }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 25%;
        }
    }

    @media (min-width: 768px) and (max-width: 991px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 33.33%;
        }
    }

    @media (max-width: 767px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 50%;
        }
    }

    @media (max-width: 576px) {
        .col-xl-2-5 {
            flex: 0 0 auto;
            width: 100%;
        }
    }
    @media (min-width: 1400px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 14.2857%;
        }
    }

    @media (min-width: 1200px) and (max-width: 1399px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 14.2857%;
        }
    }

    @media (min-width: 992px) and (max-width: 1199px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 20%;
        }
    }

    @media (min-width: 768px) and (max-width: 991px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 25%;
        }
    }

    @media (max-width: 767px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 50%;
        }
    }

    @media (max-width: 576px) {
        .col-xl-1-7 {
            flex: 0 0 auto;
            width: 100%;
        }
    }

    @media (max-width: 768px) {
        .container {
            padding: 0.75rem;
            margin: 0;
            border-radius: 10px;
            max-width: 100%;
            min-height: 100vh;
            overflow-y: auto;
        }

        body {
            background-color: #f0f2f5;
        }

        .card-body {
            padding: 0.6rem;
        }

        .card {
            margin-bottom: 0.5rem;
            min-height: 110px;
        }

        /* katheer Statistics Cards - Reduced Font Sizes */
        .col-xl-2-5 .card-body {
            padding: 0.5rem;
        }

        .col-xl-2-5 h6.card-title {
            font-size: 0.65rem;
            margin-bottom: 0.08rem !important;
            line-height: 1.1;
        }

        .col-xl-2-5 .text-muted {
            font-size: 0.55rem !important;
            line-height: 0.9;
        }

        .col-xl-2-5 h3 {
            font-size: 1rem !important;
            line-height: 1.1;
            font-weight: 700;
        }

        .col-xl-2-5 span.text-muted {
            font-size: 0.55rem !important;
        }

        .col-xl-2-5 small {
            font-size: 0.5rem !important;
        }

        .date-display {
            font-size: 0.8rem;
            width: 100%;
            text-align: center;
            padding: 0.5rem !important;
            margin-top: 0.5rem;
        }

        .date-selector {
            width: 100%;
            margin-bottom: 0.5rem;
        }

        .date-selector .form-control {
            width: 100%;
            font-size: 0.85rem;
            padding: 0.4rem;
        }

        .d-flex.align-items-center.gap-3 {
            flex-direction: column !important;
            align-items: stretch !important;
            width: 100%;
            gap: 0.5rem !important;
        }

        .col-md-4 {
            width: 100%;
        }

        .d-flex.justify-content-between.align-items-center.mb-4 {
            flex-direction: column;
            gap: 0.75rem;
        }

        h2.mb-0 {
            font-size: 1rem;
            text-align: center;
            width: 100%;
        }

        h3.mb-2, h3.mb-3 {
            font-size: 0.95rem;
            text-align: left;
            width: 100%;
            margin-bottom: 0.75rem !important;
            margin-top: 1rem !important;
        }

        .d-flex.align-items-center.mb-3 {
            flex-direction: row;
            gap: 0.5rem;
            margin-bottom: 0.5rem !important;
        }

        .rounded-circle.p-3.me-3 {
            margin: 0 !important;
            padding: 0.3rem !important;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .rounded-circle.p-2 {
            width: 32px !important;
            height: 32px !important;
            padding: 0.3rem !important;
        }

        .rounded-circle.p-2 i,
        .rounded-circle.p-3.me-3 i {
            font-size: 0.8rem !important;
        }

        .d-flex.align-items-baseline {
            justify-content: flex-start;
            flex-wrap: wrap;
        }

        .row.g-4 {
            margin: 0 !important;
            gap: 0.3rem !important;
        }

        .row.g-4 > div {
            padding-left: 0.15rem !important;
            padding-right: 0.15rem !important;
        }

        .col-xl-2-5 {
            width: 50% !important;
            flex: 0 0 auto;
        }

        .col-xl-1-7 {
            width: 25% !important;
            flex: 0 0 auto;
        }

        .col-md-2 {
            width: 50%;
        }

        h6.card-title {
            font-size: 0.7rem;
            margin-bottom: 0.1rem !important;
            line-height: 1.2;
        }

        .text-muted {
            font-size: 0.6rem !important;
            line-height: 1;
        }

        h3 {
            font-size: 1.2rem !important;
            line-height: 1.2;
            font-weight: 700;
        }

        .card-body .d-flex {
            flex-direction: column;
        }

        .text-center {
            text-align: center !important;
        }

        small {
            font-size: 0.55rem !important;
            line-height: 1;
        }

        .d-flex.flex-column.align-items-center.text-center.mb-2 {
            margin-bottom: 0.3rem !important;
        }
    }

    /* Additional responsiveness for very small screens */
    @media (max-width: 375px) {
        .container {
            padding: 0.5rem;
        }

        .card-body {
            padding: 0.5rem;
        }

        h3.mb-0 {
            font-size: 1.2rem;
        }

        h6.card-title {
            font-size: 0.75rem;
        }

        .rounded-circle.p-3.me-3 {
            width: 35px;
            height: 35px;
        }

        .rounded-circle.p-3.me-3 i {
            font-size: 0.9rem !important;
        }

        h2.mb-0 {
            font-size: 0.95rem;
        }

        .date-selector .form-control {
            font-size: 0.8rem;
            padding: 0.35rem;
        }

        .date-display {
            font-size: 0.75rem;
        }

        h3 {
            font-size: 1.1rem !important;
        }

        .text-muted {
            font-size: 0.65rem !important;
        }

        span {
            font-size: 0.75rem;
        }

        small {
            font-size: 0.6rem !important;
        }
    }

    /* Tablet view (768px - 1024px) */
    @media (min-width: 768px) and (max-width: 1024px) {
        .col-xl-2-5 {
            width: 50% !important;
        }

        .col-xl-1-7 {
            width: 33.33% !important;
        }

        .container {
            padding: 1rem;
        }
    }

</style>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script>
    function updateDashboard(date) {
        // Update display date
        const displayDate = new Date(date);
        const options = { year: 'numeric', month: 'long', day: 'numeric' };
        document.getElementById('display-date').textContent = displayDate.toLocaleDateString('en-US', options);

        // Fetch updated data from server
        fetch(`/dashboard-data/?date=${date}`)
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Update katheer cards and bird count cards
                    const cardElements = document.querySelectorAll('.card');
                    cardElements.forEach(card => {
                        const valueElement = card.querySelector('h3');
                        const cardType = card.classList[1]; // Get the second class which identifies the card type

                        if (valueElement) {
                            let value = '0';
                            if (cardType === 'katheer-tray-card') value = data.data.katheer_total_tray_eggs || '0';
                            else if (cardType === 'katheer-eggs-card') value = data.data.katheer_total_eggs || '0';
                            else if (cardType === 'egg-percentage-card') value = data.data.egg_percentage || '0';
                            else if (cardType === 'male-birds-card') value = data.data.male_current_birds || '0';
                            else if (cardType === 'female-birds-card') value = data.data.female_current_birds || '0';
                            else if (cardType === 'total-birds-card') value = data.data.total_current_birds || '0';
                            else if (cardType === 'male-mortality-card') value = data.data.male_today_mortality || '0';
                            else if (cardType === 'female-mortality-card') value = data.data.female_today_mortality || '0';
                            else if (cardType === 'total-mortality-card') value = data.data.total_mortality || '0';
                            else if (cardType === 'feed-per-bird-card') value = data.data.feed_per_gram_per_bird || '0';
                            else if (cardType === 'male-feed-bird-card') value = data.data.male_feed_per_bird || '0';
                            else if (cardType === 'female-feed-bird-card') value = data.data.female_feed_per_bird || '0';
                            else if (cardType === 'feed-today-card') value = data.data.total_feed_today || '0';
                            else if (cardType === 'closing-stock-card') value = data.data.closing_stock || '0';

                            valueElement.textContent = value;
                        }
                    });

                    // Update record existence warnings
                    const warnings = document.querySelectorAll('small.text-danger');
                    warnings.forEach(warning => {
                        warning.style.display = data.data.katheer_record_exists ? 'none' : 'block';
                    });
                } else {
                    console.error('Error:', data.message);
                }
            })
            .catch(error => {
                console.error('Error fetching dashboard data:', error);
            });
    }

    function updateCardValue(id, value, unit) {
        const elements = document.getElementsByClassName(id);
        for (let element of elements) {
            const valueDisplay = element.querySelector('h3');
            if (valueDisplay) {
                valueDisplay.textContent = value || '0';
            }
        }
    }

    function updateRecordStatus(recordType, exists) {
        const warnings = document.querySelectorAll(`.${recordType}-warning`);
        warnings.forEach(warning => {
            warning.style.display = exists ? 'none' : 'block';
        });
    }

    // Initialize dashboard with current date on page load
    document.addEventListener('DOMContentLoaded', function () {
        const currentDate = document.getElementById('dashboard-date').value;
        if (currentDate) {
            updateDashboard(currentDate);
        }
    });
</script>
{% endblock %}